---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xingweihao.
--- DateTime: 01/03/2018 4:15 PM
---
---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by xingweihao.
--- DateTime: 28/02/2018 2:41 PM
---


local GameScene = require( 'Frame.GameScene' )
---@type UIManager
local uiMgr = AppFacade.GetInstance():GetManager("UIManager")
---@class TastingTourLobbyView :GameScene
local TastingTourLobbyView = class('TastingTourLobbyView', GameScene)
function TastingTourLobbyView:ctor()
    self.super.ctor(self,'home.TastingTourLobbyView')
    self:InitUI()
end
-- 盘子的位置
local DISH_POS  =  {
    ['1'] = {
        {374,104}
    },
    ["2"] ={
        {283,106},
        {457,115}
    },
    ["3"] ={
        {180,135},
        {374,104},
        {584,140}
    },
    ["4"] ={
        {119,156},
        {283,106},
        {457,115},
        {624,178}
    }
}

local  BUTTON_CLICK = {
    REVIEW_BTN       = 1001, -- 回顾
    COMMENTS_BTN     = 1002, -- 评论按钮
    SUBMIT_BTN       = 1003, -- 提交按钮
    BEST_COMPENT_BTN = 1004, -- 小本本按钮
    BACK_BTN         = 1005, -- 返回按钮
    CLOSE_BTN        = 1006, -- 关闭按钮
    TIP_BTN          = 1007, -- 提示按钮
    SWITCH_ASSISTANT = 1008, -- 切换助手的提示
}
--==============================--
--desc:初始化界面
--time:2017-08-01 03:13:56
--@return
--==============================--
function TastingTourLobbyView:InitUI()
    -- 吞噬层
    local swallowLayer = display.newLayer(0,0,{ ap = display.CENTER , color = cc.c4b(0,0,0,0) , enable =  true })
    swallowLayer:setPosition(display.center)
    self:addChild(swallowLayer)


    local bgLayout = display.newLayer(display.width/2 , display.height/2 ,
          {ap = display.CENTER})
    self:addChild(bgLayout)
    local size = bgLayout:getContentSize()
    ------------------------------------avatarLayer ---------------------------------------------------
    -- avatarLayer
    local avatarLayer = display.newLayer(size.width/2, size.height/2, {ap = display.CENTER, size = cc.size(1334, 1002)})
    bgLayout:addChild(avatarLayer)

    local avatarFloorLayer = display.newLayer()
    avatarLayer:addChild(avatarFloorLayer)

    local avatarWallLayer = display.newLayer()
    avatarLayer:addChild(avatarWallLayer)

    local avatarNodeLayer = display.newLayer()
    avatarLayer:addChild(avatarNodeLayer)

    local avatarCeilingLayer = display.newLayer()
    avatarLayer:addChild(avatarCeilingLayer)



    -- waiter layer
    local waiterLayer = display.newLayer()
    avatarLayer:addChild(waiterLayer)

    -- bug layer
    local bugLayer = display.newLayer()
    avatarLayer:addChild(bugLayer)

    -- effect layer
    local effectLayer = display.newLayer(0, 0, {ap = display.CENTER})
    effectLayer:setPosition(utils.getLocalCenter(avatarLayer))
    avatarLayer:addChild(effectLayer)



    ------------------------------------ lobboyLayer---------------------------------------------------

    local lobboyLayer = display.newLayer(display.width/2 , display.height/2 , { ap = display.CENTER })
    bgLayout:addChild(lobboyLayer,10)

    --bottomLayout
    local bottomSize = cc.size(944, 222)
    local bottomLayout = display.newLayer(display.SAFE_L , 0 ,
    { ap = display.LEFT_BOTTOM , size = bottomSize })
    lobboyLayer:addChild(bottomLayout)
    local mainBgImage = display.newImageView(_res('ui/tastingTour/lobby/fishtravel_main_bar_bg'),
             bottomSize.width ,0 ,{ap = display.RIGHT_BOTTOM} )
    bottomLayout:addChild(mainBgImage)



    local commentsBtns = display.newButton(bottomSize.width - 95 , 60 ,
       { n = _res("ui/common/common_btn_white_default")})

    bottomLayout:addChild(commentsBtns)
    display.commonLabelParams(commentsBtns,fontWithColor('14',{text =__('评论')}))
    commentsBtns:setTag(BUTTON_CLICK.COMMENTS_BTN)
    -- 回顾按钮
    local reviewBtn = display.newButton(bottomSize.width - 270  , 60 ,
                                           { n = _res("ui/common/common_btn_white_default") , scale9 = true })
    bottomLayout:addChild(reviewBtn)
    reviewBtn:setTag(BUTTON_CLICK.REVIEW_BTN)

    display.commonLabelParams(reviewBtn,fontWithColor('14',{text =__('历史最高') , paddingW = 10 }))

    -- 上菜的Btn
    local  submitBtn = display.newButton( bottomSize.width - 345 , 32 ,
      {n =_res('ui/tastingTour/lobby/fishtravel_main_bar_btn_start') , ap = display.RIGHT_BOTTOM } )
    bottomLayout:addChild(submitBtn)
    display.commonLabelParams(submitBtn, fontWithColor('14',{text = __('上菜'), fontSize= 34,outline = '#553030' }))
    submitBtn:setTag(BUTTON_CLICK.SUBMIT_BTN)

    local submitBtnSize = submitBtn:getContentSize()
    local buyBtn = display.newButton(submitBtnSize.width/2,  submitBtnSize.height/2,
                                     {n = _res('ui/common/common_btn_green.png')})
    submitBtn:addChild(buyBtn,100)


    local tempImg = display.newImageView(_res("ui/home/lobby/cooking/refresh_ico_quick_recovery.png"),20, 31,--
                                         {ap = cc.p(0.5, 0.5)})
    buyBtn:addChild(tempImg)

    local tempImg1 = display.newImageView(_res(CommonUtils.GetGoodsIconPathById(DIAMOND_ID)),120, 31,--
                                          {ap = cc.p(1, 0.5)})
    buyBtn:addChild(tempImg1)
    tempImg1:setScale(0.2)

    local buyBtnSize = buyBtn:getContentSize()
    local timeBtn = display.newButton(buyBtnSize.width*0.5,  0 ,
                                      {n = _res('ui/home/lobby/cooking/kitchen_make_bg_info.png'),enable = false, ap  = display.CENTER_TOP, scale9 = true,size = cc.size(122,30)})
    buyBtn:addChild(timeBtn)
    display.commonLabelParams(timeBtn,{text = ' ', fontSize = 20, color = '#4c4c4c'})
    buyBtn:setVisible(false)


    ---最佳选择按钮

    local bestCompentBtn = display.newButton(bottomSize.width- 93, 180 ,
    {n = _res('ui/tastingTour/lobby/fishtravel_main_btn_hints') })
    display.commonLabelParams(bestCompentBtn, fontWithColor('14', {fontSize = 20 ,offset = cc.p(0, -45), text = __('查看提示') ,outline = '#553030'}))
    bottomLayout:addChild(bestCompentBtn)
    bestCompentBtn:setTag(BUTTON_CLICK.BEST_COMPENT_BTN)
    -- 人物的layout
    local cardSize = cc.size(220,bottomSize.height)
    local cardLayout = display.newLayer(bottomSize.width - 720, 0 , {ap = display.RIGHT_BOTTOM, size = cardSize })
    bottomLayout:addChild(cardLayout)

    local decorationImage = display.newButton(cardSize.width/2 ,0 ,
          {n =  _res('ui/tastingTour/lobby/fishtravel_main_bar_label_decopoint'), ap =display.CENTER })
    local decorationSize = decorationImage:getContentSize()
    display.commonLabelParams(decorationImage,{ap = display.LEFT_CENTER ,text = "" ,offset = cc.p(-70 , 0) , fontSize = 20})
    -- 显示装饰度
    local decorationLayout =  display.newLayer(cardSize.width/2 ,8 ,
    { size = decorationSize , ap = display.CENTER_BOTTOM   })
    cardLayout:addChild(decorationLayout)

    decorationImage:setPosition(cc.p(decorationSize.width/2 , decorationSize.height/2))
    decorationLayout:addChild(decorationImage)

    -- 装饰度的提示按钮
    local tipBtn = display.newButton(-14, decorationSize.height/2
    , { n = _res('ui/common/common_btn_tips') , ap = display.LEFT_CENTER })

    decorationLayout:addChild(tipBtn)
    tipBtn:setTag(BUTTON_CLICK.TIP_BTN)


    -- 添加人物
    local addLayoutSize  = cc.size(149 ,166 )
    local personBaseImage =  display.newImageView( _res('ui/home/lobby/peopleManage/restaurant_manage_bg_people_base.png'), addLayoutSize.width/2 , 0 , { ap = display.CENTER_BOTTOM})
    local teamImage =   display.newImageView( _res('ui/tower/path/tower_btn_team_add.png') , addLayoutSize.width/2 ,addLayoutSize.height ,{ap = display.CENTER_TOP  , enable = true })
    local petAddImage =   display.newImageView( _res('ui/common/maps_fight_btn_pet_add.png') , addLayoutSize.width/2,addLayoutSize.height,{ap = display.CENTER })
    local teamImageSize = teamImage:getContentSize()
    teamImage:setScale(0.8)
    teamImage:setName("teamImage")
    teamImage:setVisible(false)
    petAddImage:setCascadeOpacityEnabled(true)
    petAddImage:setPosition(cc.p(teamImageSize.width/2 , teamImageSize.height/2 +5))
    teamImage:addChild(petAddImage)
    teamImage:setCascadeOpacityEnabled(true)

    -- 添加队伍
    local addLayout = display.newLayer(cardSize.width/2 - 7   , 45  , { ap = display.CENTER_BOTTOM, size = addLayoutSize   , enable = true , color = cc.c4b(0,0,0,0) })
    addLayout:setTag(BUTTON_CLICK.SWITCH_ASSISTANT)
    addLayout:addChild(personBaseImage)
    addLayout:addChild(teamImage)
    addLayout:setOpacity(0)
    cardLayout:addChild(addLayout)
    --addLayout:setCascadeOpacityEnabled(true)
    -- 选择厨师的label
    local chooseCookLabel = display.newLabel(addLayoutSize.width/2 , 35 , { ap = display.CENTER_BOTTOM , fontSize = 22 , text = __('选择厨师')})
    addLayout:addChild(chooseCookLabel)
    chooseCookLabel:setName("chooseCookLabel")

    local requirementSize = cc.size(890, 525)

    local requirementLayout = display.newLayer(bottomSize.width/2 , display.height/2+40 , {size = requirementSize , ap = display.CENTER  })
    bgLayout:addChild(requirementLayout)

    -- 评委说话的内容
    local dialogBg = display.newImageView(_res('arts/stage/ui/dialogue_bg_2.png'),bottomSize.width/2 ,60 )
    local dialogBgSize =  dialogBg:getContentSize()
    local dialogSize  =  cc.size(dialogBgSize.width * 0.8 , dialogBgSize.height * 0.8 )
    dialogBg:setPosition(cc.p(dialogBgSize.width/2 * 0.8 , dialogBgSize.height/2 * 0.8))

    local dialogBgLayout = display.newLayer(bottomSize.width/2 -45, bottomSize.height/2 - 20 , { ap = display.CENTER , color1  = cc.r4b(), size = dialogSize })
    requirementLayout:addChild(dialogBgLayout,20)
    dialogBg:setScale(0.8)
    local dialogLabel = display.newLabel(60, 120, {ap = cc.p(0, 1), text = "", fontSize = 24, color = '#5b3c25', w = 500})
    dialogBgLayout:addChild(dialogBg)
    dialogBgLayout:addChild(dialogLabel)
    dialogLabel:setCascadeOpacityEnabled(true)
    dialogBg:setCascadeOpacityEnabled(true)
    dialogBgLayout:setVisible(false)



    local dishTable = {}
    local dishParentSize = cc.size(800,300)
    local dishLayout = display.newLayer(457 , 227,
        {ap = display.CENTER , size = dishParentSize })
    requirementLayout:addChild(dishLayout,2)

    
    for i =1 , 4  do
        local addLayoutSize  = cc.size(149 ,166 )
        local personBaseImage =  display.newImageView( _res('ui/tastingTour/lobby/fishtravel_main_food_ico_empty.png'), addLayoutSize.width/2 , 0 , { ap = display.CENTER_BOTTOM})
        local teamImage =   display.newImageView( _res('ui/tower/path/tower_btn_team_add.png') , addLayoutSize.width/2 ,addLayoutSize.height ,{ap = display.CENTER_TOP })
        local petAddImage =   display.newImageView( _res('ui/common/maps_fight_btn_pet_add.png') , addLayoutSize.width/2,addLayoutSize.height,{ap = display.CENTER })
        local teamImageSize = teamImage:getContentSize()
        petAddImage:setPosition(cc.p(teamImageSize.width/2 , teamImageSize.height/2 +5))
        teamImage:addChild(petAddImage)
        -- 添加队伍
        local addLayout = display.newLayer(cardSize.width/2 - 7   , 45  , { ap = display.CENTER_BOTTOM, size = addLayoutSize ,enable = true ,color = cc.c4b(0,0,0,0) })
        addLayout:addChild(personBaseImage)


        local foodName = display.newButton(addLayoutSize.width/2 , 10 ,
                                           { n = _res("ui/tastingTour/lobby/fishtravel_main_food_label_name") , ap = display.CENTER_TOP })
        addLayout:addChild(foodName,2)
        display.commonLabelParams(foodName, fontWithColor('10', {color = "#b78c73" , text = "11111"}))
        addLayout:addChild(teamImage,2)
        dishLayout:addChild(addLayout)

        local recipeName = CommonUtils.GetGoodsIconPathById('220001')
        local recipeImage = display.newImageView(recipeName ,addLayoutSize.width/2 , addLayoutSize.height/2 -25 )
        addLayout:addChild(recipeImage)
        local spineSkinPath = 'effects/tastingTour/plate'
        local qAvatar = sp.SkeletonAnimation:create(string.format("%s.json", spineSkinPath),string.format('%s.atlas', spineSkinPath), 0.7)
        qAvatar:update(0)
        qAvatar:setTag(1)
        --qAvatar:setAnimation(0, 'play2', true)
        qAvatar:setName("qAvatar")
        qAvatar:setScale(1.2)
        qAvatar:setPosition(cc.p(addLayoutSize.width/2 , addLayoutSize.height/2 -40))
        addLayout:addChild(qAvatar)
        qAvatar:setVisible(false)


        local lightPath = 'effects/tastingTour/guang'
        local lightSpine = sp.SkeletonAnimation:create(string.format("%s.json", lightPath),string.format('%s.atlas', lightPath), 0.7)
        lightSpine:update(0)
        lightSpine:setTag(1)
        lightSpine:setName("lightSpine")
        --lightSpine:setAnimation(0,'play',false)
        lightSpine:setScale(1.2)
        lightSpine:setPosition(cc.p(addLayoutSize.width/2 , addLayoutSize.height/2 -40))
        addLayout:addChild(lightSpine)
        lightSpine:setVisible(false)



        recipeImage:setScale(0.8)
        recipeImage:setName("recipeImage")
        teamImage:setName("teamImage")
        foodName:setName("foodName")
        petAddImage:setName("petAddImage")
        addLayout:setVisible(false)
        addLayout:setPosition(DISH_POS["4"][i][1],DISH_POS["4"][i][2])
        table.insert(dishTable, #dishTable+1 , addLayout)
    end
   
    -- 返回按钮
    local backBtn = display.newButton(0, 0, {n = _res("ui/common/common_btn_back")})
    backBtn:setPosition(cc.p(display.SAFE_L + backBtn:getContentSize().width * 0.5 + 30, display.height - 53))
    bgLayout:addChild(backBtn, 5)
    backBtn:setTag(BUTTON_CLICK.BACK_BTN)

    requirementLayout:setOpacity(0)
    bottomLayout:setOpacity(0)
    teamImage:setOpacity(0)
    personBaseImage:setOpacity(0)
    chooseCookLabel:setOpacity(0)


    self.viewData = {
        --------------------------底部的一些按钮------------------------------
        reviewBtn         = reviewBtn,
        submitBtn         = submitBtn,
        bestCompentBtn    = bestCompentBtn,
        commentsBtns      = commentsBtns,
        addLayout         = addLayout,
        chooseCookLabel   = chooseCookLabel,
        tipBtn            = tipBtn,
        petAddImage       = petAddImage,
        decorationImage   = decorationImage,
        requirementLayout = requirementLayout,
        avatarLayer = avatarLayer ,
        avatarFloorLayer = avatarFloorLayer ,
        avatarCeilingLayer = avatarCeilingLayer ,
        avatarNodeLayer = avatarNodeLayer ,
        effectLayer = effectLayer ,
        avatarWallLayer = avatarWallLayer ,
        -----------------------------avatarLayer------------------------------

        -----------------------------requirementLayout------------------------------
        dishTable         = dishTable,
        dishLayout        = dishLayout,
        bottomLayout      = bottomLayout,
        buyBtn            = buyBtn ,
        timeBtn           = timeBtn ,
        teamImage         = teamImage ,
        personBaseImage   = personBaseImage ,

        dialogBgLayout    = dialogBgLayout ,
        dialogBg          = dialogBg ,
        dialogLabel       = dialogLabel ,
        ------------------------------------返回按钮----------------------
        backBtn           = backBtn

    }
end



return TastingTourLobbyView
